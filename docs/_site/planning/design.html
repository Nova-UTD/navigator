<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/navigator/assets/css/just-the-docs-default.css"> <script src="/navigator/assets/js/vendor/lunr.min.js"></script> <script src="/navigator/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Behavior Planning and Controls Design Document (draft) | Navigator</title> <meta name="generator" content="Jekyll v3.9.2" /> <meta property="og:title" content="Behavior Planning and Controls Design Document (draft)" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Navigator is an open-source autonomous driving system developed by Nova, an applied research group at UT Dallas." /> <meta property="og:description" content="Navigator is an open-source autonomous driving system developed by Nova, an applied research group at UT Dallas." /> <link rel="canonical" href="http://0.0.0.0:8083/navigator/planning/design.html" /> <meta property="og:url" content="http://0.0.0.0:8083/navigator/planning/design.html" /> <meta property="og:site_name" content="Navigator" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Behavior Planning and Controls Design Document (draft)" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Navigator is an open-source autonomous driving system developed by Nova, an applied research group at UT Dallas.","headline":"Behavior Planning and Controls Design Document (draft)","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://0.0.0.0:8083/navigator/assets/res/logo.png"}},"url":"http://0.0.0.0:8083/navigator/planning/design.html"}</script> <!-- End Jekyll SEO tag --> <link rel="shortcut icon" type="image/png" href="/navigator/assets/res/favicon.png"> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/navigator/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/navigator/system-overview.html" class="nav-list-link">System overview</a></li><li class="nav-list-item"><a href="/navigator/sensing/sensing-overview.html" class="nav-list-link">Sensing</a></li><li class="nav-list-item"><a href="/navigator/perception/segmentation.html" class="nav-list-link">Semantic segmentation</a></li><li class="nav-list-item"><a href="/navigator/perception/mapping.html" class="nav-list-link">Localization and Mapping</a></li><li class="nav-list-item"><a href="/navigator/perception/perception-overview.html" class="nav-list-link">Perception</a></li><li class="nav-list-item"><a href="/navigator/contributing/tricks.html" class="nav-list-link">Tricks</a></li><li class="nav-list-item"><a href="/navigator/controls/controls-overview.html" class="nav-list-link">Controls</a></li><li class="nav-list-item"><a href="/navigator/contributing/contributing-overview.html" class="nav-list-link">Contributing</a></li><li class="nav-list-item"><a href="/navigator/simulation/simulation-overview.html" class="nav-list-link">Simulation</a></li><li class="nav-list-item"><a href="/navigator/contributing/troubleshooting.html" class="nav-list-link">Troubleshooting</a></li><li class="nav-list-item"><a href="/navigator/interface/schematics.html" class="nav-list-link">Schematics</a></li><li class="nav-list-item"><a href="/navigator/interface/interface-overview.html" class="nav-list-link">Interface</a></li><li class="nav-list-item"><a href="/navigator/planning/airbags.html" class="nav-list-link">Airbags</a></li><li class="nav-list-item active"><a href="/navigator/planning/design.html" class="nav-list-link active">Behavior Planning and Controls Design Document (draft)</a></li><li class="nav-list-item"><a href="/navigator/planning/maps.html" class="nav-list-link">Maps</a></li><li class="nav-list-item"><a href="/navigator/opendrivepy.html" class="nav-list-link">OpenDrivePy</a></li><li class="nav-list-item"><a href="/navigator/perception/perception_new.html" class="nav-list-link">Perception and Prediction Design Document (draft)</a></li><li class="nav-list-item"><a href="/navigator/planning/planning-overview.html" class="nav-list-link">Planning</a></li><li class="nav-list-item"><a href="/navigator/writing-documentation.html" class="nav-list-link">Writing documentation</a></li></ul> <ul class="nav-list"><li class="nav-list-item external"> <a href="https://nova-utd.github.io" class="nav-list-link external"> Learn about Nova <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg> </a> </li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Navigator" aria-label="Search Navigator" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//nova-utd.github.io" class="site-button" > Learn about Nova </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="behavior-planning-and-controls-design-document-draft"> <a href="#behavior-planning-and-controls-design-document-draft" class="anchor-heading" aria-labelledby="behavior-planning-and-controls-design-document-draft"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Behavior Planning and Controls Design Document (draft) </h1> <p><em>Maintained by Hansika</em></p> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#important-definitions-used-in-doc" id="markdown-toc-important-definitions-used-in-doc">Important Definitions Used in Doc:</a></li> <li><a href="#system-overview" id="markdown-toc-system-overview">System overview</a> <ol> <li><a href="#current-system" id="markdown-toc-current-system">Current system:</a> <ol> <li><a href="#planning" id="markdown-toc-planning">Planning:</a></li> <li><a href="#controls" id="markdown-toc-controls">Controls:</a></li> </ol> </li> <li><a href="#what-planning-intends-to-accomplish" id="markdown-toc-what-planning-intends-to-accomplish">What Planning intends to accomplish:</a></li> <li><a href="#what-planning-needs" id="markdown-toc-what-planning-needs">What Planning needs:</a> <ol> <li><a href="#input" id="markdown-toc-input">Input:</a></li> <li><a href="#justification" id="markdown-toc-justification">Justification:</a></li> <li><a href="#proposed-planning-system" id="markdown-toc-proposed-planning-system">Proposed Planning System:</a></li> </ol> </li> </ol> </li> <li><a href="#proposed-structure" id="markdown-toc-proposed-structure">Proposed structure</a> <ol> <li><a href="#current-state-information-required" id="markdown-toc-current-state-information-required">Current-State Information Required:</a></li> <li><a href="#representation-of-surrounding-environment" id="markdown-toc-representation-of-surrounding-environment">Representation of Surrounding Environment:</a></li> <li><a href="#dynamic-occupancy-grid" id="markdown-toc-dynamic-occupancy-grid">Dynamic Occupancy Grid:</a> <ol> <li><a href="#structure-of-grid" id="markdown-toc-structure-of-grid">Structure of Grid:</a></li> <li><a href="#information-within-cell" id="markdown-toc-information-within-cell">Information within cell:</a></li> </ol> </li> <li><a href="#conversion-to-cost-map" id="markdown-toc-conversion-to-cost-map">Conversion to Cost Map:</a> <ol> <li><a href="#determination-of-cost" id="markdown-toc-determination-of-cost">Determination of Cost:</a></li> <li><a href="#distance-from-end" id="markdown-toc-distance-from-end">Distance From End:</a></li> <li><a href="#number-of-mergesturns" id="markdown-toc-number-of-mergesturns">Number of merges/turns:</a> <ol> <li><a href="#good-traffic-navigation-protocols" id="markdown-toc-good-traffic-navigation-protocols">Good traffic navigation protocols:</a></li> </ol> </li> <li><a href="#calculation-of-path-costs" id="markdown-toc-calculation-of-path-costs">Calculation of Path Costs:</a></li> </ol> </li> </ol> </li> </ol><hr /> <h2 id="important-definitions-used-in-doc"> <a href="#important-definitions-used-in-doc" class="anchor-heading" aria-labelledby="important-definitions-used-in-doc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Important Definitions Used in Doc: </h2> <p>Configuration Space: set of all configurations of a vehicle</p> <h2 id="system-overview"> <a href="#system-overview" class="anchor-heading" aria-labelledby="system-overview"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> System overview </h2> <h3 id="current-system"> <a href="#current-system" class="anchor-heading" aria-labelledby="current-system"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Current system: </h3> <h4 id="planning"> <a href="#planning" class="anchor-heading" aria-labelledby="planning"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Planning: </h4> <p>We use zones to determine speed at given way points, acting like an ‘on-rails’ vehicle. Zones are an enclosed region of space (represented as a polygon) with a maximum speed, which may be 0 to indicate a no-entry zone. Zones may overlap (in which case the lower speed wins). Zones may come from a variety of sources but currently originate from the Behavior Planner (Traffic Planner) and the Obstacle Zoner. Zones are currently not tagged with a type or origin: all zones are anonymous and equal.</p> <h4 id="controls"> <a href="#controls" class="anchor-heading" aria-labelledby="controls"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Controls: </h4> <p>Uses pure pursuit for steering control. The velocity controller is best not mentioned and should be replaced.</p> <h3 id="what-planning-intends-to-accomplish"> <a href="#what-planning-intends-to-accomplish" class="anchor-heading" aria-labelledby="what-planning-intends-to-accomplish"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What Planning intends to accomplish: </h3> <p>Develop a planning system that can take in a prediction about where cars, pedestrians, and other dynamic agents will be several seconds in the future and how we can find the most efficient trajectory for our autonomous vehicle (hereinafter referred to as the AV) on a short-term distance to get from point A to B (&lt; a hundred feet) on a long-term path determined by widely spaced waypoints (&gt; several miles).</p> <h3 id="what-planning-needs"> <a href="#what-planning-needs" class="anchor-heading" aria-labelledby="what-planning-needs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What Planning needs: </h3> <h4 id="input"> <a href="#input" class="anchor-heading" aria-labelledby="input"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Input: </h4> <p>We choose to represent our prediction of the ground-truth state environment surrounding the AV several seconds in advanced using a Dynamic Occupancy Grid. This Dynamic Occupancy Grid will ideally hold information (in the form of probabilities) about whether a given grid cell (xn, yn) in a 2-Dimensional representation of real space (x, y) is occupied by an obstacle at some time tick t. This Dynamic Occupancy Grid will contain an individual grid frame (hereinafter referred to as a frame) for every discrete decisecond time tick for up to 3 seconds in advance of the current time state t = 0. Each of the frames in the Dynamic Occupancy Grid will be based on the local coordinate grid system around the AV.</p> <h4 id="justification"> <a href="#justification" class="anchor-heading" aria-labelledby="justification"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Justification: </h4> <p>Because safety is the highest priority when designing a AV planning system, our primary goal is to ensure that crashes never occur when our vehicle has the ability to avoid them. For simplicity, we treat all crashes with equal importance, meaning crashing with an animal, pedestrian, or other vehicles are all given equal “badness”. Defining a crash as the collision between the bounding boxes of two objects within real space, the only information we need to know is when another object’s bounding box will collide with our own. Knowing this, we can track all possible collisions with other dynamic and static objects through creating a Dynamic Occupancy Grid that tells us the spaces that contain other objects at some time t, for which we should not also occupy at that time t. The usefulness of the Dynamic Occupancy Grid is that all agents within our environment can be easily represented under the Grid because they all can be easily and efficiently sampled for any (x, y, t), whereas Zones struggled with efficiency and was unable to represent time altogether.</p> <h4 id="proposed-planning-system"> <a href="#proposed-planning-system" class="anchor-heading" aria-labelledby="proposed-planning-system"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Proposed Planning System: </h4> <p>Our proposed behavior planning and controls subsystem takes in a dynamic Occupancy Grid as the input for our planning system. Our planning system will output a path of waypoints finely spaced by equal time steps to help navigate the car to the correct location.</p> <p>In order to make this possible, we have outlined some approaches/options for planning and controls. This document outlines our proposed methods and how they fit together to form a cohesive subsystem. It describes what our system is not responsible for as well. Finally, it compares our proposed methods to Navigator’s current approach and to other popular methods in the literature.</p> <h2 id="proposed-structure"> <a href="#proposed-structure" class="anchor-heading" aria-labelledby="proposed-structure"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Proposed structure </h2> <p><img src="/navigator/assets/res/BPC_flow.png" alt="BPC_Flow" /></p> <h3 id="current-state-information-required"> <a href="#current-state-information-required" class="anchor-heading" aria-labelledby="current-state-information-required"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Current-State Information Required: </h3> <p>Position (x,y,z) Linear velocities (vx, vy, vz)</p> <p>Orientation (Theta_x, Theya_y, Theta_z) angular velocities (wx, wy, wz) (Egan: take a brief look into use of quaternions for modeling orientation and its derivatives, as that’s what currently is used)</p> <p>Short-term local coordinate transform history</p> <h3 id="representation-of-surrounding-environment"> <a href="#representation-of-surrounding-environment" class="anchor-heading" aria-labelledby="representation-of-surrounding-environment"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Representation of Surrounding Environment: </h3> <p>Source: [1]</p> <p><img src="/navigator/assets/res/bpc_surrounding_environment_rep_options.png" alt="BPC_options" /></p> <p>Voroni Diagrams: unsuitable for non-holonomic vehicles (cars)</p> <p>State lattices: repeating primitive paths which connect possible states for the vehicle [1]</p> <h3 id="dynamic-occupancy-grid"> <a href="#dynamic-occupancy-grid" class="anchor-heading" aria-labelledby="dynamic-occupancy-grid"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dynamic Occupancy Grid: </h3> <h4 id="structure-of-grid"> <a href="#structure-of-grid" class="anchor-heading" aria-labelledby="structure-of-grid"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Structure of Grid: </h4> <p>Each frame of the grid will be created around the local coordinate grid of the AV. It will span 40 meters to the left, 40 meters to the right, 40 meters behind, and 80 meters in front of the current position of the AV at time t = 0. Each grid cell will be made of squares spanning 0.2 meters long and wide. Each frame will represent a discrete time t = a/10 where a = (0, 30) such that our dynamic grid includes predictions from times t = (0, 3).</p> <p>The grid must be timestamped with when it was created so coordinate systems can be properly matched. The map is accessed via M[t, x,y], where higher values of x and y are to the front and right of the vehicle respectively. (The rear leftmost point is index (0,0)).</p> <h4 id="information-within-cell"> <a href="#information-within-cell" class="anchor-heading" aria-labelledby="information-within-cell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Information within cell: </h4> <p>Each cell is associated with a probability of cell being occupied by an obstacle (float value). This probability will be in the range [0, 1].</p> <h3 id="conversion-to-cost-map"> <a href="#conversion-to-cost-map" class="anchor-heading" aria-labelledby="conversion-to-cost-map"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Conversion to Cost Map: </h3> <h4 id="determination-of-cost"> <a href="#determination-of-cost" class="anchor-heading" aria-labelledby="determination-of-cost"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Determination of Cost: </h4> <p>The primary factor associated with cost will be crashes. Trajectories that lead to crashes will be given extremely high costs to deter the planner from choosing them. The Dynamic Occupancy Grid can be converted into a Cost Map. Other factors to associate with cost are: Travel distance, number of merges/turns, good traffic navigation protocols, etc. We would also use the measure of traffic in different lanes to help us determine cost of a given path.</p> <h4 id="distance-from-end"> <a href="#distance-from-end" class="anchor-heading" aria-labelledby="distance-from-end"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Distance From End: </h4> <p>Each path should be assigned a cost value proportional to the maximum distance from its final position of the AV and the next waypoint.</p> <p>(Egan: I’m confused about this one. The point is that we maximize travel distance in the direction we want to go, and costs are relative to other paths, so consant cost increase don’t matter.) (Response – Chitsein: I think I was thinking incorrectly about travel distance’s relevance to the cost map – I meant for it to originally represent the travel distance between two points a and b. I realize that the RRT won’t be creating paths to get from a point a to b, but will rather find all paths that could be taken by the AV, so I think making Travel Distance represent a cost proportional to the maximum distance like you suggested would be the better design. )</p> <h4 id="number-of-mergesturns"> <a href="#number-of-mergesturns" class="anchor-heading" aria-labelledby="number-of-mergesturns"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Number of merges/turns: </h4> <p>Increasing the cost of a path every time the AV merges or makes a turn to deter from paths that make unneccessary merges or turns. For example, we probably don’t want the vehicle to be merging in and out of lanes constantly on the highway to move a little faster at the expense of slowing down others cars it merges in front of and possibly increasing risk of collision.</p> <h5 id="good-traffic-navigation-protocols"> <a href="#good-traffic-navigation-protocols" class="anchor-heading" aria-labelledby="good-traffic-navigation-protocols"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Good traffic navigation protocols: </h5> <p>Increase the cost of a path that do not follow good traffic navigation protocols. For example, imagine there is a line up of cars to turn right into the highway. Based on the cost map before good traffic navigation protocols are applied, the car could choose to turn into the left lane and then try to merge at the front of the line because it would decrease the time taken to get onto the highway. However, this would go against courteous driving practices, so we should teach the AV to wait it’s turn in the line.</p> <h4 id="calculation-of-path-costs"> <a href="#calculation-of-path-costs" class="anchor-heading" aria-labelledby="calculation-of-path-costs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Calculation of Path Costs: </h4> <p>Each path’s cost is calculated based on the summation of the costs of each grid cell at time t (C[t, x, y]) plus the other factors associated with cost, including distance from end, number of merges/turns, and good traffic navigation protocols.</p> <p>Cost for travel from a given to another: Source [4]</p> <p>We can represent the points into a graph with vertices being possible options given current position and environment. Edges are the transition from a given point (where AV currently is) to next point. We weight transition to be the following equation: Source [4]</p> <p><img src="/navigator/assets/res/bpc_cost_map_method.png" alt="Cost_math_method" /></p> <p>Proposal (Egan, I think this makes sense, I also think that we may need to tweak this conversion when we try to decide algorithms that work best for RRTs - Hansika): We may additionally want a cost function more general than a summation over occupied cells. The specific case I’m thinking of is we want to encode that, where possible, the vehicle should end in drivable area at the prediction horizon- we don’t want to attempt to overtake where since it looks good now, but when the horizon rolls forward the vehicle realizes it was impossible halfway through. This cannot be encoded by a cost map alone. So a more general approach is: C(P)=∑C_i (P), where Pis the path under consideration, C(P) is the associated cost, and C_i (P) is a component cost function. So grid cost C_g (P)=∑8<em>t▒∑</em>{x \〖in X〗<em>t }▒∑</em>{y∈Y_t }▒〖C[t,x,y]〗</p> <p>Tweaks based on the 10/13 meeting: We have two places to inject cost, which is the RRT cost function evaluated on a per-node basis and a function of the leaf nodes. • RRT cost: cost that can be evaluated at each node without knowing where it will end up ○ Cost map: occupancy grid, road semantics (drivable area) ○ Safety/Dynamic considerations: physical obtainability, difference between trajectory speed and road speed limit. A function of the state more than a lookup in the cost map. • Leaf nodes: ○ Whether the trajectory ends up in drivable area ○ Whether the trajectory ends up closer to the goal? This may be possible to push into RRT cost but makes more sense based on endpoints.</p> <p>RRTs:</p> <p>Approach 1: Algorithm for RRTs with random sampling: [1] Input requirements: Configuration Space Ouputs: best state to go to next or Xnear</p> <p>Benefits: 1. probabilistically complete a. If solution for path problem exists, RRT will find a soln with probability of 1 as running time goes to infinity 2. Guarantee kinematic feasibility 3. Quick to explore free space</p> <p>Detractions: 1. Jerky paths created 2. Strong dependence on Neares Neighbor metric 3. Need to do collision checking for every expanded node</p> <p><img src="/navigator/assets/res/bpc_rrt_algo.png" alt="bpc_rrt_algo" /></p> <p>Approach 2: Source [3]</p> <p>RRT* - works towards shortest path</p> <ol> <li>Records distance each vertex has traveled relative to parent</li> <li>Closest node to parent vertex can be replaced by node with lower cost in given radius</li> <li>Neighbhors can be changed higher up in the tree if a cheaper path is found.</li> </ol> <p>Disadvantages:</p> <ol> <li>More computationally expensive</li> </ol> <p>Psuedo Code: Source [3]:</p> <p><img src="/navigator/assets/res/bpc_rrt*_algo.png" alt="bpc_rrt_algo" /></p> <p>Approach 3: Instead of using random point, all feasible connections are evaluated and only minimum cost paths are added to the tree.</p> <p>Given a cost map, we could build off it in the following manner:</p> <ol> <li>Cost functions: c_safety and c_time calculations can be found in source [4]</li> </ol> <p>To expand tree: souce [5]</p> <ol> <li>Sample a pposition uniformly at random and then sample two dimenssionaly gaussian distribution centered at the around intial path.</li> </ol> <p><img src="/navigator/assets/res/bpc_rrt_cost.png" alt="bpc_rrt*_algo" /></p> <p>Approach 4: CL-RRT</p> <p>Tree expansion: grows a tree of feasible trajectories originating from the current vehicle state that attempts to reach a specified goal set [2]</p> <p><img src="/navigator/assets/res/bpc_cl_rrt.png" alt="bpc_cl_rrt_algo" /></p> <p>Further RRT approaches are described here: https://en.wikipedia.org/wiki/Rapidly-exploring_random_tree Once we decide on a cost map approach, we can determine an algorithm to use using the cost map to create edge weights. Using heuristic algorithms such as A-star, greedy, BFS, etc. We can see if building off the avalaible methods (cost-functions, and weight functions) mentioned above into one of these algorithms, will help with making the best decision.</p> <p>Other choices than RRTs:</p> <p>Lattice Planners: We don’t wnat to use this because we are getting a dynamic grid:</p> <p><img src="/navigator/assets/res/bpc_rrt_vs.png" alt="bpc_rrt_vs_lattice_planners" /></p> <p>Source 1: https://www.sciencedirect.com/science/article/pii/S0968090X15003447</p> <p>Source 2: https://dspace.mit.edu/bitstream/handle/1721.1/65396/Frazzoli-2009-Real-Time%20Motion%20Planning%20With%20Applications%20to%20Autonomous%20Urban%20Driving.pdf?sequence=1&amp;isAllowed=y</p> <p>Source 3: https://theclassytim.medium.com/robotic-path-planning-rrt-and-rrt-212319121378</p> <p>Source 4: https://www.scitepress.org/Papers/2012/40334/pdf/index.html</p> <p>Source 5: https://www.researchgate.net/profile/Michael-Brunner-9/publication/236847575_Hierarchical_Rough_Terrain_Motion_Planning_using_an_Optimal_Sampling-Based_Method/links/0c9605196187ad600f000000/Hierarchical-Rough-Terrain-Motion-Planning-using-an-Optimal-Sampling-Based-Method.pdf</p> <p>Creating occupancy map: https://www.scitepress.org/Papers/2012/40334/pdf/index.html -&gt; to share with perception team if they want</p> <p>Control:</p> <p>Current System (Severely lacking, high potential): • PurePursuit ○ Tracking algorithm enabling the vehicle’s steering wheel to smoothly adjust steering angle in relation to the curve of the given trajectory. ○ ***Possibly can breakdown this algorithm and apply similar smoothing to other aspects of our vehicle’s movement, such as velocity, acceleration, breaking.</p> <p>Input: Final, Unidisputed Trajectory: Set of discrete points, x(t), in a local coordinate system taken at time t0 Current Vehicle State Coordinate transform history between t0 and now</p> <p>Output: Commands to hardware on vehicle</p> <p>Planned System: • PurePursuit likely kept ○ Possibly expanded/using similar approaches to smoothing velocity along trajectory • Input: ○ Final, Unidisputed Trajectory: Set of discrete points (waypoints), x(t) or v(t) [Depends on RRT and how we determine cost-effective routes) • Output: ○ Precise commands to vehicle hardware ▪ Steering ▪ Pedal ▪ Break ○ Communicate with HFE team PurePursuit More PurePursuit</p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
